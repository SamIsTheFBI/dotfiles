#!/bin/sh

#slowfade function from dark-dryu/i3lock-widgets-config

slowfade () {
    dis=$(echo -n "$DISPLAY" | tr -c '[:alnum:]' _)
    ifc='com.github.chjj.compton'
    obj='/com/github/chjj/compton'
    if [[ "$1" == "start" ]]; then
        dbus-send --print-reply --dest=$ifc.$dis \
            $obj $ifc.opts_set string:fade_in_step double:0.02
        dbus-send --print-reply --dest=$ifc.$dis \
            $obj $ifc.opts_set string:fade_out_step double:0.02
    else
        dbus-send --print-reply --dest=$ifc.$dis \
            $obj $ifc.opts_set string:fade_in_step double:0.1
        dbus-send --print-reply --dest=$ifc.$dis \
            $obj $ifc.opts_set string:fade_out_step double:0.1
    fi
}

sleep 1 && eww -c ~/.local/bin/lockscreen/ open-many battery song &
slowfade start 
i3lock -n -F -i ~/.local/share/wallpaper/lockscreen.png --clock --radius=15 --date-str="%a, %d %b %Y" \
	--{time,date,layout,verif,wrong,greeter}-font="JetBrainsMono Nerd Font" \
	--ind-pos="x+679:y+457" \
	--time-pos="ix+1:iy-70" \
	--{verif,wrong}-color="#ffffff" \
	--verif-pos="ix+1:iy-70" \
	--verif-text="Verifying..." \
	--wrong-pos="ix+1:iy-70" \
	--wrong-text="Incorrect password" \
	--noinput-text="No input was given" \
	--date-color=#ffffff \
	--time-color=#ffffff \
	--inside-color=#00000000 \
	--line-color=#ffffff \
	--ring-color=#ffffff \
	--ring-width=4 \
	--pass-media-keys \
	--pass-screen-keys \
	--pass-volume-keys \
	--pass-power-keys
slowfade end
eww -c ~/.local/bin/lockscreen/ close-all
